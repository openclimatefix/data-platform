# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: fcfsapi/forecast.proto, fcfsapi/location.proto, fcfsapi/quartzui.proto, fcfsapi/service.proto
# plugin: python-betterproto
from dataclasses import dataclass
from datetime import datetime
from typing import AsyncGenerator, List, Optional

import betterproto
import grpclib


class EnergySource(betterproto.Enum):
    ENERGY_SOURCE_UNSPECIFIED = 0
    ENERGY_SOURCE_SOLAR = 1
    ENERGY_SOURCE_WIND = 2


@dataclass
class CreateModelRequest(betterproto.Message):
    name: str = betterproto.string_field(1)
    version: str = betterproto.string_field(2)
    make_default: bool = betterproto.bool_field(3)


@dataclass
class CreateModelResponse(betterproto.Message):
    model_id: int = betterproto.int32_field(1)


@dataclass
class PredictedGenerationValue(betterproto.Message):
    horizon_mins: int = betterproto.int32_field(1)
    p50: int = betterproto.int32_field(2)
    p10: int = betterproto.int32_field(3)
    p90: int = betterproto.int32_field(4)
    metadata: str = betterproto.string_field(5)


@dataclass
class Forecast(betterproto.Message):
    model_id: int = betterproto.int32_field(1)
    location_id: int = betterproto.int32_field(2)
    init_time_utc: datetime = betterproto.message_field(3)


@dataclass
class CreateForecastRequest(betterproto.Message):
    forecast: "Forecast" = betterproto.message_field(1)
    predicted_generation_values: List["PredictedGenerationValue"] = (
        betterproto.message_field(2)
    )


@dataclass
class CreateForecastResponse(betterproto.Message):
    forecast_id: int = betterproto.int64_field(1)


@dataclass
class CreateSiteRequest(betterproto.Message):
    """
    --- Locations
    ----------------------------------------------------------------
    """

    name: str = betterproto.string_field(1)
    latitude: float = betterproto.float_field(2)
    longitude: float = betterproto.float_field(3)
    capacity_kw: int = betterproto.int64_field(4)
    metadata: str = betterproto.string_field(5)


@dataclass
class CreateGspRequest(betterproto.Message):
    name: str = betterproto.string_field(1)
    geometry: str = betterproto.string_field(2)
    capacity_mw: int = betterproto.int64_field(3)
    metadata: str = betterproto.string_field(4)


@dataclass
class CreateLocationResponse(betterproto.Message):
    location_id: int = betterproto.int32_field(1)


@dataclass
class GetLocationRequest(betterproto.Message):
    location_id: int = betterproto.int32_field(1)


@dataclass
class GetLocationResponse(betterproto.Message):
    location_id: int = betterproto.int32_field(1)
    name: str = betterproto.string_field(2)
    latitude: float = betterproto.float_field(3)
    longitude: float = betterproto.float_field(4)
    capacity_kw: int = betterproto.int64_field(5)
    metadata: str = betterproto.string_field(6)


@dataclass
class GetLocationsAsGeoJSONRequest(betterproto.Message):
    location_ids: List[int] = betterproto.int32_field(1)
    unsimplified: bool = betterproto.bool_field(2)


@dataclass
class GetLocationsAsGeoJSONResponse(betterproto.Message):
    geojson: str = betterproto.string_field(1)


@dataclass
class Yield(betterproto.Message):
    yield_kw: int = betterproto.int64_field(1)
    timestamp_unix: int = betterproto.int64_field(2)


@dataclass
class YieldPrediction(betterproto.Message):
    yield_kw: int = betterproto.int64_field(1)
    timestamp_unix: int = betterproto.int64_field(2)
    uncertainty: "YieldPredictionUncertainty" = betterproto.message_field(3)


@dataclass
class YieldPredictionUncertainty(betterproto.Message):
    lower_kw: int = betterproto.int64_field(1)
    upper_kw: int = betterproto.int64_field(2)


@dataclass
class YieldDelta(betterproto.Message):
    delta_kw: int = betterproto.sint64_field(1)
    timestamp_unix: int = betterproto.int64_field(2)


@dataclass
class GetPredictedTimeseriesRequest(betterproto.Message):
    location_ids: List[int] = betterproto.int32_field(1)
    energy_source: "EnergySource" = betterproto.enum_field(2)
    # * The desired difference between the initialisation time and the target
    # time in minutes. 0 gives the most recently predicted values.
    horizon_mins: int = betterproto.int32_field(3)


@dataclass
class GetPredictedTimeseriesResponse(betterproto.Message):
    location_id: int = betterproto.int32_field(1)
    yields: List["YieldPrediction"] = betterproto.message_field(2)


@dataclass
class GetPredictedTimeseriesDeltasResponse(betterproto.Message):
    location_id: int = betterproto.int32_field(1)
    deltas: List["YieldDelta"] = betterproto.message_field(2)


@dataclass
class GetObservedTimeseriesRequest(betterproto.Message):
    location_ids: List[str] = betterproto.string_field(1)
    energy_source: "EnergySource" = betterproto.enum_field(2)


@dataclass
class GetObservedTimeseriesResponse(betterproto.Message):
    location_id: int = betterproto.int32_field(1)
    yields: List["Yield"] = betterproto.message_field(2)


@dataclass
class GetPredictedCrossSectionRequest(betterproto.Message):
    location_ids: List[int] = betterproto.int32_field(1)
    energy_source: "EnergySource" = betterproto.enum_field(2)
    timestamp_unix: int = betterproto.int64_field(3)


@dataclass
class GetPredictedCrossSectionResponse(betterproto.Message):
    timestamp_unix: int = betterproto.int64_field(1)
    yields_kw: List[int] = betterproto.int64_field(2)


@dataclass
class GetLatestForecastRequest(betterproto.Message):
    location_id: int = betterproto.int32_field(1)
    energy_source: "EnergySource" = betterproto.enum_field(2)


@dataclass
class GetLatestForecastResponse(betterproto.Message):
    location_id: int = betterproto.int32_field(1)
    forecast_id: int = betterproto.int64_field(2)
    yields: List["YieldPrediction"] = betterproto.message_field(3)


class QuartzAPIStub(betterproto.ServiceStub):
    async def get_predicted_timeseries(
        self,
        *,
        location_ids: List[int] = [],
        energy_source: "EnergySource" = 0,
        horizon_mins: int = 0,
    ) -> AsyncGenerator[GetPredictedTimeseriesResponse, None]:
        request = GetPredictedTimeseriesRequest()
        request.location_ids = location_ids
        request.energy_source = energy_source
        request.horizon_mins = horizon_mins

        async for response in self._unary_stream(
            "/fcfsapi.QuartzAPI/GetPredictedTimeseries",
            request,
            GetPredictedTimeseriesResponse,
        ):
            yield response

    async def get_predicted_timeseries_deltas(
        self,
        *,
        location_ids: List[int] = [],
        energy_source: "EnergySource" = 0,
        horizon_mins: int = 0,
    ) -> AsyncGenerator[GetPredictedTimeseriesDeltasResponse, None]:
        request = GetPredictedTimeseriesRequest()
        request.location_ids = location_ids
        request.energy_source = energy_source
        request.horizon_mins = horizon_mins

        async for response in self._unary_stream(
            "/fcfsapi.QuartzAPI/GetPredictedTimeseriesDeltas",
            request,
            GetPredictedTimeseriesDeltasResponse,
        ):
            yield response

    async def get_predicted_cross_section(
        self,
        *,
        location_ids: List[int] = [],
        energy_source: "EnergySource" = 0,
        timestamp_unix: int = 0,
    ) -> GetPredictedCrossSectionResponse:
        request = GetPredictedCrossSectionRequest()
        request.location_ids = location_ids
        request.energy_source = energy_source
        request.timestamp_unix = timestamp_unix

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/GetPredictedCrossSection",
            request,
            GetPredictedCrossSectionResponse,
        )

    async def get_observed_timeseries(
        self, *, location_ids: List[str] = [], energy_source: "EnergySource" = 0
    ) -> AsyncGenerator[GetObservedTimeseriesResponse, None]:
        request = GetObservedTimeseriesRequest()
        request.location_ids = location_ids
        request.energy_source = energy_source

        async for response in self._unary_stream(
            "/fcfsapi.QuartzAPI/GetObservedTimeseries",
            request,
            GetObservedTimeseriesResponse,
        ):
            yield response

    async def get_latest_forecast(
        self, *, location_id: int = 0, energy_source: "EnergySource" = 0
    ) -> GetLatestForecastResponse:
        request = GetLatestForecastRequest()
        request.location_id = location_id
        request.energy_source = energy_source

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/GetLatestForecast",
            request,
            GetLatestForecastResponse,
        )

    async def get_locations_as_geo_j_s_o_n(
        self, *, location_ids: List[int] = [], unsimplified: bool = False
    ) -> GetLocationsAsGeoJSONResponse:
        request = GetLocationsAsGeoJSONRequest()
        request.location_ids = location_ids
        request.unsimplified = unsimplified

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/GetLocationsAsGeoJSON",
            request,
            GetLocationsAsGeoJSONResponse,
        )

    async def create_solar_site(
        self,
        *,
        name: str = "",
        latitude: float = 0,
        longitude: float = 0,
        capacity_kw: int = 0,
        metadata: str = "",
    ) -> CreateLocationResponse:
        request = CreateSiteRequest()
        request.name = name
        request.latitude = latitude
        request.longitude = longitude
        request.capacity_kw = capacity_kw
        request.metadata = metadata

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/CreateSolarSite",
            request,
            CreateLocationResponse,
        )

    async def create_solar_gsp(
        self,
        *,
        name: str = "",
        geometry: str = "",
        capacity_mw: int = 0,
        metadata: str = "",
    ) -> CreateLocationResponse:
        request = CreateGspRequest()
        request.name = name
        request.geometry = geometry
        request.capacity_mw = capacity_mw
        request.metadata = metadata

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/CreateSolarGsp",
            request,
            CreateLocationResponse,
        )

    async def get_solar_location(self, *, location_id: int = 0) -> GetLocationResponse:
        request = GetLocationRequest()
        request.location_id = location_id

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/GetSolarLocation",
            request,
            GetLocationResponse,
        )

    async def create_model(
        self, *, name: str = "", version: str = "", make_default: bool = False
    ) -> CreateModelResponse:
        request = CreateModelRequest()
        request.name = name
        request.version = version
        request.make_default = make_default

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/CreateModel",
            request,
            CreateModelResponse,
        )

    async def create_solar_forecast(
        self,
        *,
        forecast: Optional["Forecast"] = None,
        predicted_generation_values: List["PredictedGenerationValue"] = [],
    ) -> CreateForecastResponse:
        request = CreateForecastRequest()
        if forecast is not None:
            request.forecast = forecast
        if predicted_generation_values is not None:
            request.predicted_generation_values = predicted_generation_values

        return await self._unary_unary(
            "/fcfsapi.QuartzAPI/CreateSolarForecast",
            request,
            CreateForecastResponse,
        )
